<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
<title>폴로닉스 과거데이터 수집</title>
</head>
<body>
	<br>
	이더리움 클래식 과거데이터 수집
	<br><hr>

	<script type="text/javascript" src="scripts/jquery-3.1.1.js"></script>
	
	<form action="coin" method="post" name="coinReq">
		<input type="hidden" id="command" value ="etcInsert" name="command" > 
		<input type="hidden" id="etcData" name="etcData">
	</form>
	
	<br><br>&nbsp;&nbsp;&nbsp;<button onclick="submitReq()">서버에 전송</button>
	
	<script type="text/javascript">
   	 window.onload = function(){
   		getEtcData();
   	} 
   	 
      function getEtcData() {
   	  $.ajax({
   	 // start, end Unix Timestamp GMT+1 기준 period : 4시간 주기 
       url : "https://poloniex.com/public?command=returnChartData&currencyPair=USDT_ETC&start=1498834800&end=1499436000&period=14400",
       method : "post",
       dataType : "html",
       success : function(result) {
          
    	  var jsonData = JSON.parse(result);
          var data = new Array();
          var close = "";
          var volume = "";
          for (var i = 0; i < jsonData.length; i++){
             data[i] =timeConverter(jsonData[i].date)+"/"+(jsonData[i].close*1122)+"/"+(jsonData[i].volume)+"/"+"1";
          }
          $("#etcData").val(data);
       }
    });
      }
      
		function timeConverter(UNIX_timestamp) {
			var a = new Date(UNIX_timestamp * 1000);
			var months = [ '01', '02', '03', '04', '05', '06', '07', '08',	'09', '10', '11', '12' ];
			var dates = [ '01', '02', '03', '04', '05', '06', '07', '08', '09',
					'10', '11', '12', '13', '14', '15', '16', '17', '18', '19',
					'20', '21', '22', '23', '24', '25', '26', '27', '28', '29',
					'30', '31' ];
			var hours = [ '00', '01', '02', '03', '04', '05', '06', '07', '08',	'09', '10',
					'11', '12', '13', '14', '15', '16', '17', '18','19', '20', '21', '22', '23' ];
			var mins = [ '00', '01', '02', '03', '04', '05', '06', '07', '08','09', '10',
					'11', '12', '13', '14', '15', '16', '17', '18','19', '20',
					'21', '22', '23', '24', '25', '26', '27', '28','29', '30',
					'31', '32', '33', '34', '35', '36', '37', '38','39', '40',
					'41', '42', '43', '44', '45', '46', '47', '48','49', '50',
					'51', '52', '53', '54', '55', '56', '57', '58', '59' ];
			var secs = [ '00', '01', '02', '03', '04', '05', '06', '07', '08',
					'09', '10', '11', '12', '13', '14', '15', '16', '17', '18',
					'19', '20', '21', '22', '23', '24', '25', '26', '27', '28',
					'29', '30', '31', '32', '33', '34', '35', '36', '37', '38',
					'39', '40', '41', '42', '43', '44', '45', '46', '47', '48',
					'49', '50', '51', '52', '53', '54', '55', '56', '57', '58',
					'59' ];
			var year = a.getFullYear();
			var month = months[a.getMonth()];
			var date = dates[a.getDate() - 1];
			var hour = hours[a.getHours() - 1];
			var min = mins[a.getMinutes()];
			var sec = secs[a.getSeconds()];
			var time = year + '-' + month + '-' + date + ' ' + hour + ':' + min + ':' + sec;
			return time;
		}
		
		function submitReq(){
			 document.coinReq.submit();
		}
	</script>

</body>
</html>